<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

    <style>
        /* Scoped Gallery Page */
.gallery-page {
    height: 100%;
    width: 100%;
    min-height: 100vh;
    font-family: Arial, sans-serif;
    background: #f8f9fa;
    display: flex;
    flex-direction: column;
}

/* Button container */
.gallery-page .gallery-container {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    padding: 20px;
    background: #fff;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    position: sticky;
    top: 0;
    z-index: 100;
}

/* Gallery output grid */
.gallery-page #gallery-output {
    flex: 1;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    padding: 20px;
}

/* Media items */
.gallery-page #gallery-output img,
.gallery-page #gallery-output video {
    width: 100%;
    height: 100%;
    max-height: 400px;
    object-fit: cover;
    border-radius: 12px;
    border: 1px solid #ddd;
    box-shadow: 0 6px 12px rgba(0,0,0,0.1);
    background: #fff;
}

/* Empty state text */
.gallery-page #gallery-output p {
    grid-column: 1/-1;
    text-align: center;
    font-size: 1.4em;
    color: #666;
    margin-top: 20px;
}

/* Pagination */
.gallery-page #pagination {
    margin: 20px auto;
}

    </style>
</head>

<body class="p-4">

<body>
    <div class="gallery-page">
        <div class="gallery-container mb-3">
            <button class="btn btn-primary me-2" onclick="show_rooms('attached-room')">Attached Room</button>
            <button class="btn btn-primary me-2" onclick="show_rooms('nonattached-room')">Non-Attached Room</button>
            <button class="btn btn-primary me-2" onclick="show_rooms('others')">Others</button>
            <button class="btn btn-primary" onclick="show_rooms('video')">Videos</button>
        </div>

        <div id="gallery-output" class="mt-3">
            <p>Select a category to view images or videos.</p>
        </div>

        <div id="pagination" class="d-flex justify-content-center mt-3"></div>
    </div>
</body>


    <script>
        let currentPage = 1;
        let itemsPerPage = 10;
        let currentFiles = [];
        let activeCategory = "";

        function show_rooms(galleryId) {
            var XHttp = new XMLHttpRequest();
            XHttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    var parser = new DOMParser();
                    var xmlDoc = parser.parseFromString(this.responseText, "text/xml");
                    var rooms = xmlDoc.getElementsByTagName("file");

                    currentFiles = [];
                    activeCategory = galleryId;

                    for (var i = 0; i < rooms.length; i++) {
                        if (rooms[i].getAttribute("id") === galleryId) {
                            currentFiles.push(rooms[i].textContent.trim());
                        }
                    }

                    // Sort numerically (so 1.jpg < 10.jpg < 11.jpg)
                    currentFiles.sort((a, b) =>
                        a.localeCompare(b, undefined, { numeric: true })
                    );

                    currentPage = 1;
                    renderPage();
                }
            };
            XHttp.open("GET", "gallery.xml", true);
            XHttp.send();
        }

        function renderPage() {
            let start = (currentPage - 1) * itemsPerPage;
            let end = start + itemsPerPage;
            let paginatedItems = currentFiles.slice(start, end);

            let output = "";
            paginatedItems.forEach(file => {
                if (activeCategory === "video") {
                    output += `
                        <video controls autoplay muted loop>
                            <source src="../assets/rooms/${file}" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>`;
                } else {
                    output += `<img src="../assets/rooms/${file}" alt="${activeCategory}">`;
                }
            });

            document.getElementById("gallery-output").innerHTML =
                output || "<p>No items found.</p>";

            // Render pagination buttons
            let totalPages = Math.ceil(currentFiles.length / itemsPerPage);
            if (totalPages > 1) {
                let paginationHtml = `
                    <button class="btn btn-secondary me-2" onclick="changePage(-1)" ${currentPage === 1 ? "disabled" : ""}>Prev</button>
                    <span class="align-self-center"> Page ${currentPage} of ${totalPages} </span>
                    <button class="btn btn-secondary ms-2" onclick="changePage(1)" ${currentPage === totalPages ? "disabled" : ""}>Next</button>
                `;
                document.getElementById("pagination").innerHTML = paginationHtml;
            } else {
                document.getElementById("pagination").innerHTML = "";
            }
        }

        function changePage(direction) {
            let totalPages = Math.ceil(currentFiles.length / itemsPerPage);
            currentPage += direction;
            if (currentPage < 1) currentPage = 1;
            if (currentPage > totalPages) currentPage = totalPages;
            renderPage();
        }
    </script>

</body>

</html>